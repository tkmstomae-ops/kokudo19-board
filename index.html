<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="google-site-verification" content="nrHQM1thvkFe3psK2UTsdHLJAkjS6mLH6FYu8iyxNYg" />

  <title>å¸°ã£ã¦ããŸR19ï½œå›½é“19å· é“è·¯æƒ…å ±æ²ç¤ºæ¿</title>
  <meta name="description" content="å›½é“19å·ï¼ˆå¡©å°»ã€œæœ¨æ›½ç¦å³¶ã€œå¤§æ¡‘æ‘ã€œä¸­æ´¥å·ï¼‰ã®é“è·¯çŠ¶æ³ã‚’ã€ãƒ‰ãƒ©ã‚¤ãƒãƒ¼åŒå£«ã§å…±æœ‰ã™ã‚‹éå…¬å¼æ²ç¤ºæ¿ã§ã™ã€‚åŒ¿åã§æŠ•ç¨¿ã§ãã¾ã™ã€‚">
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    :root {
      --bg: #0f172a;
      --card: #111827;
      --accent: #38bdf8;
      --accent-soft: rgba(56, 189, 248, 0.15);
      --border: #1f2933;
      --text: #e5e7eb;
      --muted: #9ca3af;
      --danger: #f97373;
      --radius: 10px;
      --space: 16px;
      --shadow-soft: 0 16px 40px rgba(0, 0, 0, 0.35);
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont,
        "Helvetica Neue", sans-serif;
      background: radial-gradient(circle at top, #1f2937 0, #020617 55%);
      color: var(--text);
      min-height: 100vh;
      padding: 16px;
    }

    .page {
      max-width: 1100px;
      margin: 0 auto;
      display: grid;
      grid-template-columns: minmax(0, 2fr) minmax(0, 1.2fr);
      gap: 20px;
    }

    @media (max-width: 900px) {
      .page {
        grid-template-columns: minmax(0, 1fr);
      }
    }

    header {
      max-width: 1100px;
      margin: 0 auto 16px;
    }

    .title {
      font-size: 1.4rem;
      font-weight: 700;
      display: inline-flex;
      align-items: center;
      gap: 10px;
    }

    .title-badge {
      font-size: 0.75rem;
      letter-spacing: 0.06em;
      padding: 3px 8px;
      border-radius: 999px;
      background: var(--accent-soft);
      color: #7dd3fc;
      border: 1px solid rgba(56, 189, 248, 0.4);
    }

    .subtitle {
      margin-top: 4px;
      font-size: 0.9rem;
      color: var(--muted);
    }

    .notice {
      margin-top: 10px;
      padding: 10px 12px;
      font-size: 0.8rem;
      border-radius: var(--radius);
      background: rgba(248, 250, 252, 0.03);
      border: 1px solid rgba(148, 163, 184, 0.25);
      line-height: 1.6;
    }

    .notice strong {
      color: #facc15;
    }

    .notice ul {
      padding-left: 1.1em;
      margin: 6px 0 0;
    }

    .notice li {
      margin: 2px 0;
    }

    .card {
      background: radial-gradient(circle at top left, #111827 0, #020617 70%);
      border-radius: var(--radius);
      padding: var(--space);
      border: 1px solid var(--border);
      box-shadow: var(--shadow-soft);
    }

    .card-header {
      display: flex;
      justify-content: space-between;
      align-items: baseline;
      gap: 8px;
      margin-bottom: 10px;
    }

    .card-title {
      font-size: 1rem;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .card-title-tag {
      font-size: 0.7rem;
      padding: 2px 8px;
      border-radius: 999px;
      background: rgba(15, 118, 110, 0.2);
      border: 1px solid rgba(45, 212, 191, 0.5);
      color: #a5f3fc;
    }

    .card-sub {
      font-size: 0.78rem;
      color: var(--muted);
    }

    .field-group {
      display: grid;
      grid-template-columns: repeat(3, minmax(0, 1fr));
      gap: 8px;
      margin-bottom: 8px;
    }
        
    /* Xã‚»ã‚¯ã‚·ãƒ§ãƒ³ã ã‘å°‘ã—å°ã•ã‚ã«ã™ã‚‹ */
    .card.mlit-card {
        padding: 1rem 1.25rem;
        min-height: auto;
    }

    .card.mlit-card .mlit-frame-wrap {
        padding: 0.3rem 0.2rem;
    }

    @media (max-width: 900px) {
      .field-group {
        grid-template-columns: minmax(0, 1fr);
      }
    }

    label {
      font-size: 0.78rem;
      display: block;
      margin-bottom: 4px;
      color: var(--muted);
    }

    input[type="text"],
    select,
    textarea {
      width: 100%;
      padding: 7px 9px;
      border-radius: 7px;
      border: 1px solid rgba(148, 163, 184, 0.55);
      background-color: rgba(15, 23, 42, 0.8);
      color: var(--text);
      font-size: 0.86rem;
      outline: none;
    }

    input::placeholder,
    textarea::placeholder {
      color: #6b7280;
    }

    textarea {
      min-height: 96px;
      resize: vertical;
      line-height: 1.5;
      margin-top: 2px;
    }

    .help-text {
      font-size: 0.72rem;
      color: var(--muted);
      margin-top: 4px;
      line-height: 1.4;
    }

    .status-chips {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      margin-top: 4px;
    }

    .chip {
      font-size: 0.7rem;
      padding: 3px 7px;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.5);
      color: var(--muted);
    }

    .chip span {
      margin-right: 3px;
    }

    .actions {
      display: flex;
      justify-content: flex-end;
      margin-top: 8px;
    }

    .button-primary {
      border: none;
      border-radius: 999px;
      padding: 7px 16px;
      font-size: 0.86rem;
      font-weight: 600;
      cursor: pointer;
      background: linear-gradient(135deg, #22c55e, #0ea5e9);
      color: #f9fafb;
      box-shadow: 0 8px 20px rgba(34, 197, 94, 0.4);
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }

    .button-primary:hover {
      opacity: 0.95;
    }

    .button-primary span {
      font-size: 1.1rem;
    }

    .posts-list {
      margin: 0;
      padding: 0;
      list-style: none;
      display: flex;
      flex-direction: column;
      gap: 8px;
      max-height: 520px;
      overflow-y: auto;
    }

    .post-empty {
      font-size: 0.8rem;
      color: var(--muted);
      text-align: center;
      padding: 36px 0;
    }

    .post {
      padding: 10px 11px;
      border-radius: 9px;
      background: rgba(15, 23, 42, 0.96);
      border: 1px solid rgba(30, 64, 175, 0.7);
      display: flex;
      flex-direction: column;
      gap: 4px;
      font-size: 0.86rem;
    }

    .post-header {
      display: flex;
      justify-content: space-between;
      gap: 10px;
      align-items: baseline;
      font-size: 0.8rem;
    }

    .post-main {
      white-space: pre-wrap;
    }

    .post-meta {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      margin-top: 4px;
      font-size: 0.75rem;
    }

    .meta-pill {
      border-radius: 999px;
      padding: 2px 7px;
      background: rgba(30, 64, 175, 0.4);
      color: #bfdbfe;
    }

    .meta-pill.section {
      background: rgba(6, 95, 70, 0.5);
      color: #a7f3d0;
    }

    .meta-pill.status-normal {
      background: rgba(22, 163, 74, 0.4);
      color: #bbf7d0;
    }

    .meta-pill.status-warning {
      background: rgba(234, 179, 8, 0.4);
      color: #fef9c3;
    }

    .meta-pill.status-danger {
      background: rgba(220, 38, 38, 0.5);
      color: #fecaca;
    }

    .meta-pill.status-ice {
      background: rgba(56, 189, 248, 0.4);
      color: #e0f2fe;
    }

    .mlit-card {
      height: 100%;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .mlit-note {
      font-size: 0.78rem;
      color: var(--muted);
      line-height: 1.5;
    }

    .mlit-frame-wrap {
      flex: 1;
      min-height: 350px;
      border-radius: 9px;
      overflow: hidden;
      background: #020617;
      border: 1px solid rgba(148, 163, 184, 0.4);
    }

    .mlit-frame-wrap-inner {
      height: 100%;
      overflow: auto;
    }
  </style>
</head>
<body>
  <header>
    <h1 class="title">
      <span>å¸°ã£ã¦ããŸR19</span>
      <span class="title-badge">BETA / å€‹äººé‹å–¶</span>
    </h1>
    <p class="subtitle">
      å›½é“19å·ã®ã€Œã„ã¾ã€ã‚’å…±æœ‰ã™ã‚‹ãŸã‚ã®æ²ç¤ºæ¿ã§ã™ã€‚
    </p>
    <div class="notice">
      <strong>âš  ã”æ³¨æ„</strong><br />
      ã“ã®ã‚µã‚¤ãƒˆã¯å€‹äººãŒé‹å–¶ã™ã‚‹<strong>éå…¬å¼</strong>ã®æƒ…å ±å…±æœ‰ã‚µã‚¤ãƒˆã§ã™ã€‚æŠ•ç¨¿å†…å®¹ã¯ã‚ãã¾ã§åˆ©ç”¨è€…å€‹äººã®ä½“é¨“ãƒ»å°è±¡ã§ã‚ã‚Šã€
      å›½åœŸäº¤é€šçœãƒ»é•·é‡çœŒãƒ»å¸‚ç”ºæ‘ãªã©ã®<strong>å…¬å¼ãªé“è·¯æƒ…å ±ã§ã¯ã‚ã‚Šã¾ã›ã‚“</strong>ã€‚<br />
      æœ€æ–°ã‹ã¤æ­£ç¢ºãªé€šè¡Œæƒ…å ±ã¯ã€å¿…ãšå…¬å¼ã®é“è·¯æƒ…å ±ã‚„è‡ªæ²»ä½“ãƒ»å›½ã®ç™ºè¡¨ã‚’ã”ç¢ºèªãã ã•ã„ã€‚<br />
      <ul>
        <li>å€‹äººåãƒ»è»Šä¸¡ãƒŠãƒ³ãƒãƒ¼ãªã©ã®ç‰¹å®šã«ã¤ãªãŒã‚‹å†…å®¹ã¯æ›¸ãè¾¼ã¾ãªã„ã§ãã ã•ã„ã€‚</li>
        <li>èª¹è¬—ä¸­å‚·ãƒ»å·®åˆ¥çš„è¡¨ç¾ãªã©ã€å…¬åºè‰¯ä¿—ã«åã™ã‚‹æŠ•ç¨¿ã¯ç®¡ç†äººãŒå‰Šé™¤ã™ã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚</li>
        <li>ä¸€éƒ¨ã®ãƒ–ãƒ©ã‚¦ã‚¶ã§ã¯æŠ•ç¨¿ã§ããªã„å ´åˆãŒã‚ã‚Šã¾ã™ã€‚ãã®å ´åˆã¯åˆ¥ã®ãƒ–ãƒ©ã‚¦ã‚¶ã‹ã‚‰ãŠè©¦ã—ãã ã•ã„ã€‚</li>
      </ul>
    </div>
  </header>

        <main class="page">

            <!-- â‘  æŠ•ç¨¿ã‚»ã‚¯ã‚·ãƒ§ãƒ³ï¼ˆãƒ•ã‚©ãƒ¼ãƒ ï¼‰ -->
            <section class="card">
                <div class="card-header">
                <div class="card-title">
                    åŒ¿åã§æŠ•ç¨¿ã™ã‚‹
                    <span class="card-title-tag">ãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ ã®ã¿</span>
                </div>
                <div class="card-sub">æ–°ã—ã„æŠ•ç¨¿ãŒä¸Šã«è¡¨ç¤ºã•ã‚Œã¾ã™</div>
                </div>

                <!-- æŠ•ç¨¿ãƒ•ã‚©ãƒ¼ãƒ  -->
                <form id="post-form">
                <div class="field-group">
                    <div>
                    <label for="nickname">ãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ  *</label>
                    <input
                        type="text"
                        id="nickname"
                        name="nickname"
                        placeholder="ä¾‹ï¼šçŒ«ã£ã½ã„ãƒ‰ãƒ©ã‚¤ãƒãƒ¼"
                        required
                    />
                    </div>
                    <div>
                    <label for="section">åŒºé–“ï¼ˆä»»æ„ï¼‰</label>
                    <select id="section" name="section">
                        <option value="">é¸æŠã—ãªã„</option>
                        <option value="å¡©å°»ã€œæœ¨æ›½ç¦å³¶">å¡©å°» â‡„ æœ¨æ›½ç¦å³¶</option>
                        <option value="æœ¨æ›½ç¦å³¶ã€œå¤§æ¡‘æ‘">æœ¨æ›½ç¦å³¶ â‡„ å¤§æ¡‘æ‘</option>
                        <option value="å¤§æ¡‘æ‘ã€œä¸­æ´¥å·">å¤§æ¡‘æ‘ â‡„ ä¸­æ´¥å·</option>
                        <option value="ãã®ä»–">ãã®ä»–</option>
                    </select>
                    </div>
                    <div>
                    <label for="status">çŠ¶æ³ï¼ˆä»»æ„ï¼‰</label>
                    <select id="status" name="status">
                        <option value="">é¸æŠã—ãªã„</option>
                        <option value="é€šå¸¸">ğŸŸ¢ é€šå¸¸</option>
                        <option value="æ¸‹æ»">ğŸŸ¡ æ¸‹æ»</option>
                        <option value="äº‹æ•…">ğŸ”´ äº‹æ•…ãƒ»è»Šä¸¡ãƒˆãƒ©ãƒ–ãƒ«</option>
                        <option value="é€šè¡Œæ­¢ã‚">â›” é€šè¡Œæ­¢ã‚</option>
                        <option value="å‡çµ">â„ è·¯é¢å‡çµãƒ»ç©é›ª</option>
                    </select>
                    </div>
                </div>

                <div>
                    <label for="body">é“è·¯çŠ¶æ³ã®ã‚ˆã†ã™ *</label>
                    <textarea
                    id="body"
                    name="body"
                    maxlength="280"
                    placeholder="ä¾‹ï¼š11/14 19æ™‚ã”ã‚ã€å¤§æ¡‘â†’ä¸­æ´¥å· ä¸Šã‚Šã€‚ãƒã‚³ãƒã‚³ãƒˆãƒ³ãƒãƒ«æ‰‹å‰ã§çŒ«ä¼šè­°ä¸­ã®ãŸã‚ç‰‡å´äº¤äº’é€šè¡Œã€‚15åˆ†ã»ã©ã®å¾…ã¡æ™‚é–“ã§ã—ãŸã€‚"
                    required
                    ></textarea>
                </div>

                <div class="status-chips">
                    <div class="chip"><span>ğŸŸ¢</span>é€šå¸¸</div>
                    <div class="chip"><span>ğŸŸ¡</span>æ¸‹æ»</div>
                    <div class="chip"><span>ğŸ”´</span>äº‹æ•…/ãƒˆãƒ©ãƒ–ãƒ«</div>
                    <div class="chip"><span>â›”</span>é€šè¡Œæ­¢ã‚</div>
                    <div class="chip"><span>â„</span>å‡çµ/ç©é›ª</div>
                </div>

                <div class="actions">
                    <button type="submit" class="button-primary">
                    <span>â¤</span>
                    æŠ•ç¨¿ã™ã‚‹
                    </button>
                </div>
                </form>
            </section>

            <!-- â‘¡ ã¿ã‚“ãªã®æŠ•ç¨¿ -->
            <section class="card" aria-label="æŠ•ç¨¿ä¸€è¦§">
                <div class="card-header">
                <div class="card-title">ã¿ã‚“ãªã®æŠ•ç¨¿</div>
                <div class="card-sub">æœ€æ–°ã®æŠ•ç¨¿ãŒä¸Šã«è¡¨ç¤ºã•ã‚Œã¾ã™</div>
                </div>

                <ul id="posts-list" class="posts-list">
                <li class="post-empty">
                    ã¾ã æŠ•ç¨¿ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚æœ€åˆã®é“è·¯çŠ¶æ³ã‚’æ•™ãˆã¦ãã ã•ã„ ğŸš—
                </li>
                </ul>
            </section>

            <!-- â‘¢ ãƒªãƒ³ã‚¯ï¼ˆä¸­èº«ã¯ãã®ã¾ã¾ï¼‰ -->
            <section class="card mlit-card">
                <div class="card-header">
                <div class="card-title">
                    å…¬å¼æƒ…å ±ãƒªãƒ³ã‚¯
                </div>
                </div>

                <p class="mlit-note">
                  é€šè¡Œæƒ…å ±ãƒ»è¦åˆ¶ãƒ»æ³¨æ„å–šèµ·ãªã©ã¯ã€å¿…ãšã“ã¡ã‚‰ã®å…¬å¼æƒ…å ±ã‚‚ã‚ã‚ã›ã¦ã”ç¢ºèªãã ã•ã„ã€‚
                </p>

                <a
                href="https://x.com/mlit_iida"
                target="_blank"
                rel="noopener noreferrer"
                style="
                    display: inline-flex;
                    align-items: center;
                    justify-content: center;
                    gap: 0.4rem;
                    padding: 0.55rem 1.5rem;
                    border-radius: 999px;
                    background: #1d9bf0;
                    color: #ffffff;
                    font-size: 0.9rem;
                    text-decoration: none;
                    width: fit-content;
                    margin: 0.75rem auto 0;
                "
                >
                é£¯ç”°å›½é“äº‹å‹™æ‰€ Xï¼ˆ@mlit_iidaï¼‰ã‚’é–‹ã
                <span style="font-size: 0.9rem;">â†—</span>
                </a>

                <a
                    href="https://www.jartic.or.jp/"
                    target="_blank"
                    rel="noopener noreferrer"
                    style="
                      display: inline-flex;
                      align-items: center;
                      justify-content: center;
                      gap: 0.4rem;
                      padding: 0.55rem 0.9rem;
                      border-radius: 999px;
                      background: #1d9bf0;
                      color: #ffffff;
                      font-size: 0.9rem;
                      text-decoration: none;
                      width: fit-content;
                      margin: 0.5rem auto 0;
                    "
                    >
                    æ—¥æœ¬é“è·¯äº¤é€šæƒ…å ±ã‚»ãƒ³ã‚¿ãƒ¼ï¼ˆJARTICï¼‰ã‚’é–‹ã
                    <span style="font-size: 0.9rem;">â†—</span>
                  </a>
             
              </section>
        </main>


    <!-- Supabase ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆï¼ˆCDNç‰ˆï¼‰ -->
  <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
  <script>
    // â˜… è‡ªåˆ†ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆURLã¨ anon key ã‚’ã‚»ãƒƒãƒˆ
    const SUPABASE_URL = "https://xsexclpcwikibafthpax.supabase.co";
    const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InhzZXhjbHBjd2lraWJhZnRocGF4Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjMxMTU5MzcsImV4cCI6MjA3ODY5MTkzN30.ailIkdZH6HWFNZJX8dhXbdg89rx23L1C3yzRDKAeTqM";

    const supabase = window.supabase.createClient(
      SUPABASE_URL,
      SUPABASE_ANON_KEY
    );

    // â˜… æŠ•ç¨¿é–“éš”ï¼ˆãƒŸãƒªç§’ï¼‰: ä»Šå›ã¯ 1åˆ† = 60000ms
    const POST_INTERVAL_MS = 60 * 1000;
    const form = document.getElementById("post-form");
    const postsList = document.getElementById("posts-list");

    // æ—¥ä»˜è¡¨ç¤ºã‚’æ—¥æœ¬æ™‚é–“ã§å°‘ã—ãã‚Œã„ã«æ•´ãˆã‚‹
    function formatDate(dt) {
      if (!dt) return "";
      const d = new Date(dt);
      return d.toLocaleString("ja-JP", {
        month: "2-digit",
        day: "2-digit",
        hour: "2-digit",
        minute: "2-digit",
        timeZone: "Asia/Tokyo",
      });
    }

    // å–å¾—ã—ãŸæŠ•ç¨¿ã‚’HTMLã¨ã—ã¦æç”»ã™ã‚‹
    function renderPosts(posts) {
      postsList.innerHTML = "";

      if (!posts || posts.length === 0) {
        const li = document.createElement("li");
        li.className = "post-empty";
        li.textContent = "ã¾ã æŠ•ç¨¿ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚æœ€åˆã®é“è·¯çŠ¶æ³ã‚’æ•™ãˆã¦ãã ã•ã„ ğŸš—";
        postsList.appendChild(li);
        return;
      }

      for (const post of posts) {
        const li = document.createElement("li");
        li.className = "post";

        // ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ç”¨ã®ã‚¯ãƒ©ã‚¹æŒ¯ã‚Šåˆ†ã‘
        let statusClass = "meta-pill";
        if (post.status === "é€šå¸¸") statusClass += " status-normal";
        else if (post.status === "æ¸‹æ»") statusClass += " status-warning";
        else if (post.status === "äº‹æ•…") statusClass += " status-danger";
        else if (post.status === "é€šè¡Œæ­¢ã‚") statusClass += " status-danger";
        else if (post.status === "å‡çµ") statusClass += " status-ice";

        li.innerHTML = `
          <div class="post-header">
            <div><strong>${post.nickname || "ãªãªã—"}</strong></div>
            <div style="font-size:0.75rem; color:#9ca3af;">
              ${formatDate(post.created_at)}
            </div>
          </div>
          <div class="post-main">${post.body || ""}</div>
          <div class="post-meta">
            ${
              post.section
                ? `<span class="meta-pill section">${post.section}</span>`
                : ""
            }
            ${
              post.status
                ? `<span class="${statusClass}">${post.status}</span>`
                : ""
            }
          </div>
        `;

        postsList.appendChild(li);
      }
    }

    // Supabase ã‹ã‚‰æœ€æ–°ã®æŠ•ç¨¿ã‚’å–å¾—ã™ã‚‹
    async function fetchPosts() {
      const { data, error } = await supabase
            .from("posts")
            .select("*")
            .eq("hidden", false) // â˜… hidden=false ã®ã‚‚ã®ã ã‘
            .order("created_at", { ascending: false })
            .limit(20);// ã¨ã‚Šã‚ãˆãšæœ€æ–°20ä»¶

      if (error) {
        console.error("å–å¾—ã‚¨ãƒ©ãƒ¼:", error);
        return;
      }

      renderPosts(data);
    }

    // ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡ â†’ Supabaseã«ä¿å­˜ â†’ ä¸€è¦§ã‚’å†å–å¾—
    form.addEventListener("submit", async (e) => {
      e.preventDefault();

      // ç›´è¿‘ã®æŠ•ç¨¿ã‹ã‚‰1åˆ†çµŒã£ã¦ã„ã‚‹ã‹ãƒã‚§ãƒƒã‚¯
          const now = Date.now();
          let lastPostAt = 0;

          try {
            lastPostAt = Number(localStorage.getItem("lastPostAt") || 0);
          } catch (e) {
            console.warn("localStorageãŒä½¿ãˆãªã„ç’°å¢ƒã®ã‚ˆã†ã§ã™:", e);
            // ã“ã“ã§ã¯ lastPostAt = 0 ã®ã¾ã¾é€²ã‚ã‚‹ï¼ˆé€£æŠ•åˆ¶é™ã¯åŠ¹ã‹ãªã„ãŒæŠ•ç¨¿ã¯ã§ãã‚‹ï¼‰
          }

      const diff = now - lastPostAt;

      if (diff < POST_INTERVAL_MS) {
        const restSec = Math.ceil((POST_INTERVAL_MS - diff) / 1000);
        alert(`é€£ç¶šæŠ•ç¨¿ã¯1åˆ†ã«1å›ã¾ã§ã§ã™ã€‚ã‚ã¨ ${restSec} ç§’ãŠå¾…ã¡ãã ã•ã„ã€‚`);
        return;
      }

      const nickname = form.nickname.value.trim();
      const section = form.section.value || null;
      const status = form.status.value || null;
      const body = form.body.value.trim();

      if (!nickname || !body) {
        alert("ãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ ã¨é“è·¯çŠ¶æ³ã®ã‚ˆã†ã™ã¯å¿…é ˆã§ã™ã€‚");
        return;
      }

      const submitButton = form.querySelector("button[type='submit']");
      submitButton.disabled = true;
      submitButton.textContent = "é€ä¿¡ä¸­...";

      const { error } = await supabase.from("posts").insert([
        {
          nickname,
          section,
          status,
          body,
        },
      ]);

        submitButton.disabled = false;
        submitButton.textContent = "æŠ•ç¨¿ã™ã‚‹";

        if (error) {
          console.error("æŠ•ç¨¿ã‚¨ãƒ©ãƒ¼:", error);
          alert(
            "æŠ•ç¨¿ã®ä¿å­˜ã«å¤±æ•—ã—ã¾ã—ãŸã€‚\n\n" +
              "ã‚¨ãƒ©ãƒ¼å†…å®¹: " +
              (error.message || "è©³ç´°ä¸æ˜") +
              "\n\n" +
              "æ”¹å–„ã—ãªã„å ´åˆã¯ã€ãƒ–ãƒ©ã‚¦ã‚¶ã‚’å¤‰ãˆã‚‹ã‹ã€ç®¡ç†äººã«ã“ã®ç”»é¢ã®å†…å®¹ã‚’ãŠçŸ¥ã‚‰ã›ãã ã•ã„ã€‚"
          );
          return;
        }


      // æŠ•ç¨¿ãŒæˆåŠŸã—ãŸã‚‰ã€Œæœ€å¾Œã®æŠ•ç¨¿æ™‚é–“ã€ã‚’è¨˜éŒ²
          try {
                localStorage.setItem("lastPostAt", String(Date.now()));
                } catch (e) {
                console.warn("localStorageã«ä¿å­˜ã§ãã¾ã›ã‚“ã§ã—ãŸ:", e);
              }

      form.reset();
      alert("æŠ•ç¨¿ã‚’ä¿å­˜ã—ã¾ã—ãŸï¼");

      // æ–°ã—ã„æŠ•ç¨¿ã‚’åæ˜ 
      fetchPosts();
    });


    // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã«æœ€æ–°æŠ•ç¨¿ã‚’å–å¾—
    fetchPosts();
  </script>
</body>
</html>
